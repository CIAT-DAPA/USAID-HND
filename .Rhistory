Sys.setenv(JAVA_HOME='C:/Program Files/Java/jre1.8.0_121')
iDir <- "W:/01_weather_stations/hnd_enee/daily_raw/_primary_files"
stFile <- "El Cajón - Cortés.xlsx"
library(rgdal)
library(proj4)
library(XLConnect)
stcat <- readWorksheet(loadWorkbook(paste0(iDir, "/", stFile)), sheet ="Diaria", header = T)
View(stcat)
library(rPython)
install.packages("rPython")
list.files(iDir)
st <- stLs[1]
stLs <- list.files(iDir)
st <- stLs[1]
st
iconv(st, to='ASCII//TRANSLIT')
iconv(st, to='ASCII//TRANSLIT').replace(" ", "")
a <- iconv(st, to='ASCII//TRANSLIT')
a
a.replace(" ", "")
a <- paste(iconv(st, to='ASCII//TRANSLIT'))
a
a.replace("", " ")
a= "a"
a
gsub("xlsx| ", "", a)
a <- paste(iconv(st, to='ASCII//TRANSLIT'))
gsub("xlsx| ", "", a)
gsub(".xlsx| ", "", a)
stRme <- gsub(".xlsx| ", "", paste(iconv(st, to='ASCII//TRANSLIT')))
stRme
stRme <- tolower(gsub(".xlsx| ", "", paste(iconv(st, to='ASCII//TRANSLIT'))))
stRme
## Carlos Navarro
## CIAT-CCAFS
## February 2017
## USAID-HND
## Needs java x-64 (if R is 64bits) https://www.java.com/en/download/manual.jsp
Sys.setenv(JAVA_HOME='C:/Program Files/Java/jre1.8.0_121')
library(rgdal)
library(proj4)
library(XLConnect)
library(rPython)
###### Convert meters to lat lon using projection for HND
iDir <- "W:/01_weather_stations/hnd_enee/daily_raw/_primary_files"
stFile <- "El Cajón - Cortés.xlsx"
oDir <- "X:/Water_Planning_System/01_weather_stations/hnd_dgrh/monthly_raw/prec-per-station"
stLs <- list.files(iDir)
for (st in stLs){
cat(st, "\n")
st <- stLs[1]
stRme <- tolower(gsub(".xlsx| ", "", paste(iconv(st, to='ASCII//TRANSLIT'))))
stcat <- readWorksheet(loadWorkbook(paste0(iDir, "/", st)), sheet ="Diaria", header = T)
write.csv(stcat, paste0(iDir, "/", stRme, ".txt"), quote = F, row.names = F, sep="\t")
}
write.table(stcat, paste0(iDir, "/", stRme, ".txt"), quote = F, row.names = F, sep="\t")
## Carlos Navarro
## CIAT-CCAFS
## February 2017
## USAID-HND
## Needs java x-64 (if R is 64bits) https://www.java.com/en/download/manual.jsp
Sys.setenv(JAVA_HOME='C:/Program Files/Java/jre1.8.0_121')
library(rgdal)
library(proj4)
library(XLConnect)
library(rPython)
###### Convert meters to lat lon using projection for HND
iDir <- "W:/01_weather_stations/hnd_enee/daily_raw/_primary_files"
stFile <- "El Cajón - Cortés.xlsx"
oDir <- "X:/Water_Planning_System/01_weather_stations/hnd_dgrh/monthly_raw/prec-per-station"
stLs <- list.files(iDir)
for (st in stLs){
cat(st, " reformatting and renaming \n")
stRme <- tolower(gsub(".xlsx| ", "", paste(iconv(st, to='ASCII//TRANSLIT'))))
stcat <- readWorksheet(loadWorkbook(paste0(iDir, "/", st)), sheet ="Diaria", header = T)
write.table(stcat, paste0(iDir, "/", stRme, ".txt"), quote = F, row.names = F, sep="\t")
}
## Needs java x-64 (if R is 64bits) https://www.java.com/en/download/manual.jsp
Sys.setenv(JAVA_HOME='C:/Program Files/Java/jre1.8.0_121')
library(rgdal)
library(proj4)
library(XLConnect)
library(rPython)
# Convert formats
iDir <- "W:/01_weather_stations/hnd_enee/daily_raw/_primary_files"
stcat <- read.csv("W:/01_weather_stations/hnd_enee/daily_raw/stations_catalog_v2.csv")
stLs <- list.files(iDir, pattern = "xlsx")
stLs
for (st in stLs){
stName <- tolower(strsplit(iconv(st, to='ASCII//TRANSLIT'), " - ")[[1]][1])
stDpto <- gsub(pattern = "\\.xlsx$", "", tolower(strsplit(iconv(st, to='ASCII//TRANSLIT'), " - ")[[1]][2]))
merge <- stcat[which(tolower(iconv(stcat$Estacion, to='ASCII//TRANSLIT')) == stName & tolower(iconv(stcat$DEPTO, to='ASCII//TRANSLIT')) == stDpto), ]
stCode <- merge$COD_NAC
cat(stName, "\t",stCode, "\n")
# stRead <- readWorksheet(loadWorkbook(paste0(iDir, "/", st)), sheet ="Diaria", header = T)
# write.table(stRead, paste0(iDir, "/", stCode, ".txt"), quote = F, row.names = F, sep="\t")
}
stName
stDpto
merge <- stcat[which(tolower(iconv(stcat$Estacion, to='ASCII//TRANSLIT')) == stName & tolower(iconv(stcat$DEPTO, to='ASCII//TRANSLIT')) == stDpto), ]
merge
stCode <- merge$COD_NAC
stCode
stLs <- list.files(iDir, pattern = "xlsx")
stLs
for (st in stLs){
stName <- tolower(strsplit(iconv(st, to='ASCII//TRANSLIT'), " - ")[[1]][1])
stDpto <- gsub(pattern = "\\.xlsx$", "", tolower(strsplit(iconv(st, to='ASCII//TRANSLIT'), " - ")[[1]][2]))
merge <- stcat[which(tolower(iconv(stcat$Estacion, to='ASCII//TRANSLIT')) == stName & tolower(iconv(stcat$DEPTO, to='ASCII//TRANSLIT')) == stDpto), ]
stCode <- merge$COD_NAC
cat(stName, "\t",stCode, "\n")
# stRead <- readWorksheet(loadWorkbook(paste0(iDir, "/", st)), sheet ="Diaria", header = T)
# write.table(stRead, paste0(iDir, "/", stCode, ".txt"), quote = F, row.names = F, sep="\t")
}
stLs <- list.files(iDir, pattern = "xlsx")
stLs
st <- stLs[1]
st
stName <- tolower(strsplit(iconv(st, to='ASCII//TRANSLIT'), " - ")[[1]][1])
stDpto <- gsub(pattern = "\\.xlsx$", "", tolower(strsplit(iconv(st, to='ASCII//TRANSLIT'), " - ")[[1]][2]))
stName
stDpto
View(stcat)
stcat[which(tolower(iconv(stcat$Estacion, to='ASCII//TRANSLIT')) == stName & tolower(iconv(stcat$DEPTO, to='ASCII//TRANSLIT')) == stDpto), ]
stcat[which(tolower(iconv(stcat$Estacion, to='ASCII//TRANSLIT')) == stName & tolower(iconv(stcat$DEPTO, to='ASCII//TRANSLIT')) == stDpto), ]$COD_NAC
merge <- stcat[which(tolower(iconv(stcat$Estacion, to='ASCII//TRANSLIT')) == stName & tolower(iconv(stcat$DEPTO, to='ASCII//TRANSLIT')) == stDpto), ]
merge
stCode <- paste(merge$COD_NAC)
stCode
cat(stName, "\t",stCode, "\n")
for (st in stLs){
stName <- tolower(strsplit(iconv(st, to='ASCII//TRANSLIT'), " - ")[[1]][1])
stDpto <- gsub(pattern = "\\.xlsx$", "", tolower(strsplit(iconv(st, to='ASCII//TRANSLIT'), " - ")[[1]][2]))
merge <- stcat[which(tolower(iconv(stcat$Estacion, to='ASCII//TRANSLIT')) == stName & tolower(iconv(stcat$DEPTO, to='ASCII//TRANSLIT')) == stDpto), ]
stCode <- paste(merge$COD_NAC)
cat(stName, "\t",stCode, "\n")
# stRead <- readWorksheet(loadWorkbook(paste0(iDir, "/", st)), sheet ="Diaria", header = T)
# write.table(stRead, paste0(iDir, "/", stCode, ".txt"), quote = F, row.names = F, sep="\t")
}
for (st in stLs){
stName <- tolower(strsplit(iconv(st, to='ASCII//TRANSLIT'), " - ")[[1]][1])
stDpto <- gsub(pattern = "\\.xlsx$", "", tolower(strsplit(iconv(st, to='ASCII//TRANSLIT'), " - ")[[1]][2]))
merge <- stcat[which(tolower(iconv(stcat$Estacion, to='ASCII//TRANSLIT')) == stName & tolower(iconv(stcat$DEPTO, to='ASCII//TRANSLIT')) == stDpto), ]
stCode <- paste(merge$COD_NAC)
cat(stName, "\t",stCode, "\n")
# stRead <- readWorksheet(loadWorkbook(paste0(iDir, "/", st)), sheet ="Diaria", header = T)
# write.table(stRead, paste0(iDir, "/", stCode, ".txt"), quote = F, row.names = F, sep="\t")
}
stcat <- read.csv("W:/01_weather_stations/hnd_enee/daily_raw/stations_catalog_v2.csv")
for (st in stLs){
stName <- tolower(strsplit(iconv(st, to='ASCII//TRANSLIT'), " - ")[[1]][1])
stDpto <- gsub(pattern = "\\.xlsx$", "", tolower(strsplit(iconv(st, to='ASCII//TRANSLIT'), " - ")[[1]][2]))
merge <- stcat[which(tolower(iconv(stcat$Estacion, to='ASCII//TRANSLIT')) == stName & tolower(iconv(stcat$DEPTO, to='ASCII//TRANSLIT')) == stDpto), ]
stCode <- paste(merge$COD_NAC)
cat(stName, "\t",stCode, "\n")
# stRead <- readWorksheet(loadWorkbook(paste0(iDir, "/", st)), sheet ="Diaria", header = T)
# write.table(stRead, paste0(iDir, "/", stCode, ".txt"), quote = F, row.names = F, sep="\t")
}
for (st in stLs){
stName <- tolower(strsplit(iconv(st, to='ASCII//TRANSLIT'), " - ")[[1]][1])
stDpto <- gsub(pattern = "\\.xlsx$", "", tolower(strsplit(iconv(st, to='ASCII//TRANSLIT'), " - ")[[1]][2]))
merge <- stcat[which(tolower(iconv(stcat$Estacion, to='ASCII//TRANSLIT')) == stName & tolower(iconv(stcat$DEPTO, to='ASCII//TRANSLIT')) == stDpto), ]
stCode <- paste(merge$COD_NAC)
cat(stName, "\t",stCode, "\n")
# stRead <- readWorksheet(loadWorkbook(paste0(iDir, "/", st)), sheet ="Diaria", header = T)
# write.table(stRead, paste0(iDir, "/", stCode, ".txt"), quote = F, row.names = F, sep="\t")
}
stcat <- read.csv("W:/01_weather_stations/hnd_enee/daily_raw/stations_catalog_v2.csv")
for (st in stLs){
stName <- tolower(strsplit(iconv(st, to='ASCII//TRANSLIT'), " - ")[[1]][1])
stDpto <- gsub(pattern = "\\.xlsx$", "", tolower(strsplit(iconv(st, to='ASCII//TRANSLIT'), " - ")[[1]][2]))
merge <- stcat[which(tolower(iconv(stcat$Estacion, to='ASCII//TRANSLIT')) == stName & tolower(iconv(stcat$DEPTO, to='ASCII//TRANSLIT')) == stDpto), ]
stCode <- paste(merge$COD_NAC)
cat(stName, "\t",stCode, "\n")
# stRead <- readWorksheet(loadWorkbook(paste0(iDir, "/", st)), sheet ="Diaria", header = T)
# write.table(stRead, paste0(iDir, "/", stCode, ".txt"), quote = F, row.names = F, sep="\t")
}
st <- stLs[8]
st
stName <- tolower(strsplit(iconv(st, to='ASCII//TRANSLIT'), " - ")[[1]][1])
stDpto <- gsub(pattern = "\\.xlsx$", "", tolower(strsplit(iconv(st, to='ASCII//TRANSLIT'), " - ")[[1]][2]))
stName
stDpto
merge <- stcat[which(tolower(iconv(stcat$Estacion, to='ASCII//TRANSLIT')) == stName & tolower(iconv(stcat$DEPTO, to='ASCII//TRANSLIT')) == stDpto), ]
merge
stcat <- read.csv("W:/01_weather_stations/hnd_enee/daily_raw/stations_catalog_v2.csv")
stName <- tolower(strsplit(iconv(st, to='ASCII//TRANSLIT'), " - ")[[1]][1])
stDpto <- gsub(pattern = "\\.xlsx$", "", tolower(strsplit(iconv(st, to='ASCII//TRANSLIT'), " - ")[[1]][2]))
merge <- stcat[which(tolower(iconv(stcat$Estacion, to='ASCII//TRANSLIT')) == stName & tolower(iconv(stcat$DEPTO, to='ASCII//TRANSLIT')) == stDpto), ]
merge
stCode <- paste(merge$COD_NAC)
stCode
for (st in stLs){
stName <- tolower(strsplit(iconv(st, to='ASCII//TRANSLIT'), " - ")[[1]][1])
stDpto <- gsub(pattern = "\\.xlsx$", "", tolower(strsplit(iconv(st, to='ASCII//TRANSLIT'), " - ")[[1]][2]))
merge <- stcat[which(tolower(iconv(stcat$Estacion, to='ASCII//TRANSLIT')) == stName & tolower(iconv(stcat$DEPTO, to='ASCII//TRANSLIT')) == stDpto), ]
stCode <- paste(merge$COD_NAC)
cat(stName, "\t",stCode, "\n")
# stRead <- readWorksheet(loadWorkbook(paste0(iDir, "/", st)), sheet ="Diaria", header = T)
# write.table(stRead, paste0(iDir, "/", stCode, ".txt"), quote = F, row.names = F, sep="\t")
}
stcat <- read.csv("W:/01_weather_stations/hnd_enee/daily_raw/stations_catalog_v2.csv")
stcat <- read.csv("W:/01_weather_stations/hnd_enee/daily_raw/stations_catalog_v2.csv")
stLs <- list.files(iDir, pattern = "xlsx")
for (st in stLs){
stName <- tolower(strsplit(iconv(st, to='ASCII//TRANSLIT'), " - ")[[1]][1])
stDpto <- gsub(pattern = "\\.xlsx$", "", tolower(strsplit(iconv(st, to='ASCII//TRANSLIT'), " - ")[[1]][2]))
merge <- stcat[which(tolower(iconv(stcat$Estacion, to='ASCII//TRANSLIT')) == stName & tolower(iconv(stcat$DEPTO, to='ASCII//TRANSLIT')) == stDpto), ]
stCode <- paste(merge$COD_NAC)
cat(stName, "\t",stCode, "\n")
# stRead <- readWorksheet(loadWorkbook(paste0(iDir, "/", st)), sheet ="Diaria", header = T)
# write.table(stRead, paste0(iDir, "/", stCode, ".txt"), quote = F, row.names = F, sep="\t")
}
## Carlos Navarro
## CIAT-CCAFS
## February 2017
## USAID-HND
## Needs java x-64 (if R is 64bits) https://www.java.com/en/download/manual.jsp
Sys.setenv(JAVA_HOME='C:/Program Files/Java/jre1.8.0_121')
library(rgdal)
library(proj4)
library(XLConnect)
# Convert formats
iDir <- "W:/01_weather_stations/hnd_enee/daily_raw/_primary_files"
stcat <- read.csv("W:/01_weather_stations/hnd_enee/daily_raw/stations_catalog_v2.csv")
# List of the stations in xlsx format
stLs <- list.files(iDir, pattern = "xlsx")
for (st in stLs){
stName <- tolower(strsplit(iconv(st, to='ASCII//TRANSLIT'), " - ")[[1]][1])
stDpto <- gsub(pattern = "\\.xlsx$", "", tolower(strsplit(iconv(st, to='ASCII//TRANSLIT'), " - ")[[1]][2]))
# Merge with the catalog
merge <- stcat[which(tolower(iconv(stcat$Estacion, to='ASCII//TRANSLIT')) == stName & tolower(iconv(stcat$DEPTO, to='ASCII//TRANSLIT')) == stDpto), ]
stCode <- paste(merge$COD_NAC)
cat(stName, "\t",stCode, "\n")
stRead <- readWorksheet(loadWorkbook(paste0(iDir, "/", st)), sheet ="Diaria", header = T)
write.table(stRead, paste0(iDir, "/", stCode, ".txt"), quote = F, row.names = F, sep="\t")
}
## Carlos Navarro
## CIAT-CCAFS
## February 2017
## USAID-HND
## Needs java x-64 (if R is 64bits) https://www.java.com/en/download/manual.jsp
Sys.setenv(JAVA_HOME='C:/Program Files/Java/jre1.8.0_121')
library(rgdal)
library(proj4)
library(XLConnect)
# Convert formats
iDir <- "W:/01_weather_stations/hnd_enee/daily_raw/_primary_files"
stcat <- read.csv("W:/01_weather_stations/hnd_enee/daily_raw/stations_catalog_v2.csv")
# List of the stations in xlsx format
stLs <- list.files(iDir, pattern = "xlsx")
for (st in stLs){
stName <- tolower(strsplit(iconv(st, to='ASCII//TRANSLIT'), " - ")[[1]][1])
stDpto <- gsub(pattern = "\\.xlsx$", "", tolower(strsplit(iconv(st, to='ASCII//TRANSLIT'), " - ")[[1]][2]))
# Merge with the catalog
merge <- stcat[which(tolower(iconv(stcat$Estacion, to='ASCII//TRANSLIT')) == stName & tolower(iconv(stcat$DEPTO, to='ASCII//TRANSLIT')) == stDpto), ]
stCode <- paste(merge$COD_NAC)
cat(stName, "\t",stCode, "\n")
stRead <- readWorksheet(loadWorkbook(paste0(iDir, "/", st)), sheet ="Diaria", header = T)
write.table(stRead, paste0(iDir, "/", stCode, ".txt"), quote = F, row.names = F, sep="\t")
}
## Carlos Navarro
## CIAT-CCAFS
## February 2017
## USAID-HND
## Needs java x-64 (if R is 64bits) https://www.java.com/en/download/manual.jsp
Sys.setenv(JAVA_HOME='C:/Program Files/Java/jre1.8.0_121')
library(rgdal)
library(proj4)
library(XLConnect)
# Convert formats
iDir <- "W:/01_weather_stations/hnd_enee/daily_raw/_primary_files"
stcat <- read.csv("W:/01_weather_stations/hnd_enee/daily_raw/stations_catalog_v2.csv")
# List of the stations in xlsx format
stLs <- list.files(iDir, pattern = "xlsx")
for (st in stLs){
stName <- tolower(strsplit(iconv(st, to='ASCII//TRANSLIT'), " - ")[[1]][1])
stDpto <- gsub(pattern = "\\.xlsx$", "", tolower(strsplit(iconv(st, to='ASCII//TRANSLIT'), " - ")[[1]][2]))
# Merge with the catalog
merge <- stcat[which(tolower(iconv(stcat$Estacion, to='ASCII//TRANSLIT')) == stName & tolower(iconv(stcat$DEPTO, to='ASCII//TRANSLIT')) == stDpto), ]
stCode <- paste(merge$COD_NAC)
cat(stName, "\t",stCode, "\n")
stRead <- readWorksheet(loadWorkbook(paste0(iDir, "/", st)), sheet ="Diaria", header = T)
write.table(stRead, paste0(iDir, "/", stCode, ".txt"), quote = F, row.names = F, sep="\t")
}
## Carlos Navarro
## CIAT-CCAFS
## February 2017
## USAID-HND
## Needs java x-64 (if R is 64bits) https://www.java.com/en/download/manual.jsp
Sys.setenv(JAVA_HOME='C:/Program Files/Java/jre1.8.0_121')
library(rgdal)
library(proj4)
library(XLConnect)
# Convert formats
iDir <- "W:/01_weather_stations/hnd_enee/daily_raw/_primary_files"
stcat <- read.csv("W:/01_weather_stations/hnd_enee/daily_raw/stations_catalog_v2.csv")
# List of the stations in xlsx format
stLs <- list.files(iDir, pattern = "xlsx")
for (st in stLs){
stName <- tolower(strsplit(iconv(st, to='ASCII//TRANSLIT'), " - ")[[1]][1])
stDpto <- gsub(pattern = "\\.xlsx$", "", tolower(strsplit(iconv(st, to='ASCII//TRANSLIT'), " - ")[[1]][2]))
# Merge with the catalog
merge <- stcat[which(tolower(iconv(stcat$Estacion, to='ASCII//TRANSLIT')) == stName & tolower(iconv(stcat$DEPTO, to='ASCII//TRANSLIT')) == stDpto), ]
stCode <- paste(merge$COD_NAC)
cat(stName, "\t",stCode, "\n")
stRead <- readWorksheet(loadWorkbook(paste0(iDir, "/", st)), sheet ="Diaria", header = T)
write.table(stRead, paste0(iDir, "/", stCode, ".txt"), quote = F, row.names = F, sep="\t", na = "")
}
st <- stLs[34]
st
st <- stLs[33]
st
stName <- tolower(strsplit(iconv(st, to='ASCII//TRANSLIT'), " - ")[[1]][1])
stDpto <- gsub(pattern = "\\.xlsx$", "", tolower(strsplit(iconv(st, to='ASCII//TRANSLIT'), " - ")[[1]][2]))
# Merge with the catalog
merge <- stcat[which(tolower(iconv(stcat$Estacion, to='ASCII//TRANSLIT')) == stName & tolower(iconv(stcat$DEPTO, to='ASCII//TRANSLIT')) == stDpto), ]
stCode <- paste(merge$COD_NAC)
cat(stName, "\t",stCode, "\n")
stRead <- readWorksheet(loadWorkbook(paste0(iDir, "/", st)), sheet ="Diaria", header = T)
write.table(stRead, paste0(iDir, "/", stCode, ".txt"), quote = F, row.names = F, sep="\t", na = "")
stName <- tolower(strsplit(iconv(st, to='ASCII//TRANSLIT'), " - ")[[1]][1])
stDpto <- gsub(pattern = "\\.xlsx$", "", tolower(strsplit(iconv(st, to='ASCII//TRANSLIT'), " - ")[[1]][2]))
# Merge with the catalog
merge <- stcat[which(tolower(iconv(stcat$Estacion, to='ASCII//TRANSLIT')) == stName & tolower(iconv(stcat$DEPTO, to='ASCII//TRANSLIT')) == stDpto), ]
stCode <- paste(merge$COD_NAC)
cat(stName, "\t",stCode, "\n")
stRead <- readWorksheet(loadWorkbook(paste0(iDir, "/", st)), sheet ="Diaria", header = T)
write.table(stRead, paste0(iDir, "/", stCode, ".txt"), quote = F, row.names = F, sep="\t", na = "")
for (st in stLs){
stName <- tolower(strsplit(iconv(st, to='ASCII//TRANSLIT'), " - ")[[1]][1])
stDpto <- gsub(pattern = "\\.xlsx$", "", tolower(strsplit(iconv(st, to='ASCII//TRANSLIT'), " - ")[[1]][2]))
# Merge with the catalog
merge <- stcat[which(tolower(iconv(stcat$Estacion, to='ASCII//TRANSLIT')) == stName & tolower(iconv(stcat$DEPTO, to='ASCII//TRANSLIT')) == stDpto), ]
stCode <- paste(merge$COD_NAC)
cat(stName, "\t",stCode, "\n")
# stRead <- readWorksheet(loadWorkbook(paste0(iDir, "/", st)), sheet ="Diaria", header = T)
# write.table(stRead, paste0(iDir, "/", stCode, ".txt"), quote = F, row.names = F, sep="\t", na = "")
#
cat_sel <- rbind(cat_sel, merge)
}
write.csv(cat_sel, "W:/01_weather_stations/hnd_enee/daily_raw/stations_catalog_v2_sel.csv", quote = F, row.names = F)
cat_sel <- c()
for (st in stLs){
stName <- tolower(strsplit(iconv(st, to='ASCII//TRANSLIT'), " - ")[[1]][1])
stDpto <- gsub(pattern = "\\.xlsx$", "", tolower(strsplit(iconv(st, to='ASCII//TRANSLIT'), " - ")[[1]][2]))
# Merge with the catalog
merge <- stcat[which(tolower(iconv(stcat$Estacion, to='ASCII//TRANSLIT')) == stName & tolower(iconv(stcat$DEPTO, to='ASCII//TRANSLIT')) == stDpto), ]
stCode <- paste(merge$COD_NAC)
cat(stName, "\t",stCode, "\n")
# stRead <- readWorksheet(loadWorkbook(paste0(iDir, "/", st)), sheet ="Diaria", header = T)
# write.table(stRead, paste0(iDir, "/", stCode, ".txt"), quote = F, row.names = F, sep="\t", na = "")
#
cat_sel <- rbind(cat_sel, merge)
}
write.csv(cat_sel, "W:/01_weather_stations/hnd_enee/daily_raw/stations_catalog_v2_sel.csv", quote = F, row.names = F)
